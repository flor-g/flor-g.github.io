<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Personal Site</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="home-page">
  <header class="page-header">
    <h1>Flora Gu | 顧 思悤</h1>
  </header>

  <main>
    <section id="intro">
      <h2>A Visitor's Guide</h2>
      <p>
        Hello there! I am Flora and this is an archive of me. I am born and raised in Shenzhen, a relatvely young city in Southern China. I spent the second half of my adolescence at an all-girl boarding high school in Massachusetts, USA. I am now an undergraduate student of Linguistics at University College London, UK. <br><br>If you are interested in my trajectory of thought, you are more than welcome to make yourself at home here. This site is still in construction, so please excuse the mess. If you are not too interested in the ambiguous part of me, I totally feel you---my résumé is at the bottom of this page. 
      </p>
    </section>

    <section id="papers">
      <header class="section-header">
        <h2>Papers &amp; Essays</h2>
        <button class="toggle-slots" type="button" aria-expanded="false" aria-controls="papers-slots" data-show-text="Show" data-hide-text="Hide">Show</button>
      </header>
      <div class="slots" id="papers-slots" hidden>
        <div class="slot slot-placeholder" aria-label="Add paper link"></div>
        <div class="slot slot-placeholder" aria-label="Add paper link"></div>
        <div class="slot slot-placeholder" aria-label="Add paper link"></div>
      </div>
    </section>

    <section id="writings">
      <header class="section-header">
        <h2>Casual writings &amp; Collection of folk texts </h2>
        <button class="toggle-slots" type="button" aria-expanded="false" aria-controls="writings-slots" data-show-text="Show" data-hide-text="Hide">Show</button>
      </header>
      <div class="slots" id="writings-slots" hidden>
        <div class="slot slot-placeholder" aria-label="Add writing link"></div>
        <div class="slot slot-placeholder" aria-label="Add writing link"></div>
        <div class="slot slot-placeholder" aria-label="Add writing link"></div>
      </div>
    </section>

     <section id="projects">
      <header class="section-header">
        <h2>Projects</h2>
        <button class="toggle-slots" type="button" aria-expanded="false" aria-controls="projects-slots" data-show-text="Show" data-hide-text="Hide">Show</button>
      </header>
      <div class="slots" id="projects-slots" hidden>
        <div class="slot slot-placeholder" aria-label="Add paper link"></div>
        <div class="slot slot-placeholder" aria-label="Add paper link"></div>
        <div class="slot slot-placeholder" aria-label="Add paper link"></div>
      </div>
    </section>

    <section id="cv">
      <header class="section-header">
        <h2>Résumé</h2>
        <button class="toggle-slots" type="button" aria-expanded="false" aria-controls="cv-slots" data-show-text="Show" data-hide-text="Hide">Show</button>
      </header>
      <div class="slots" id="cv-slots" hidden>
        <iframe
          src="https://docs.google.com/gview?embedded=true&url=https%3A%2F%2Fdrive.google.com%2Fuc%3Fexport%3Ddownload%26id%3D1kWJDU0prcTPiqW-G9fVHpHVG9HC_RVza"
          width="100%"
          height="450"
          style="border:0;"
          allow="fullscreen"
        ></iframe>
      </div>
    </section>
  </main>

  <footer></footer>

  <script src="papers-data.js"></script>
  <script>
    (function () {
      const normalizeDocuments = (value) =>
        Array.isArray(value) ? value.filter((doc) => doc && doc.title) : [];

      const populateSlots = (slotsElement, documents, { targetPage }) => {
        if (!slotsElement || !documents.length) {
          return;
        }

        const fragment = document.createDocumentFragment();

        documents.forEach((doc) => {
          const link = document.createElement('a');
          link.className = 'slot slot-link';

          const label = document.createElement('span');
          label.className = 'slot-link-label';
          label.textContent = doc.title;

          let href = targetPage;
          if (doc.id && !String(doc.id).startsWith('REPLACE_WITH')) {
            href = `${targetPage}?doc=${encodeURIComponent(doc.id)}`;
            link.setAttribute('data-doc-id', doc.id);
          }

          link.href = href;

          const icon = document.createElement('span');
          icon.className = 'slot-link-icon';
          icon.setAttribute('aria-hidden', 'true');
          icon.textContent = '↗';

          link.append(label, icon);
          fragment.appendChild(link);
        });

        slotsElement.replaceChildren(fragment);
      };

      populateSlots(
        document.getElementById('papers-slots'),
        normalizeDocuments(window.papersDocuments),
        { targetPage: 'papers.html' }
      );

      populateSlots(
        document.getElementById('writings-slots'),
        normalizeDocuments(window.casualWritingDocuments),
        { targetPage: 'writings.html' }
      );

      document.querySelectorAll('.toggle-slots').forEach((button) => {
        const controlsId = button.getAttribute('aria-controls');
        const slots = controlsId
          ? document.getElementById(controlsId)
          : button.closest('section')?.querySelector('.slots');

        if (!slots) {
          return;
        }

        const showLabel = button.dataset.showText || 'Show';
        const hideLabel = button.dataset.hideText || 'Hide';

        const syncButtonState = (expanded) => {
          button.setAttribute('aria-expanded', String(expanded));
          slots.hidden = !expanded;
          button.textContent = expanded ? hideLabel : showLabel;
        };

        const initialExpanded = button.getAttribute('aria-expanded');
        syncButtonState(initialExpanded === 'false' ? false : true);

        button.addEventListener('click', () => {
          const expanded = button.getAttribute('aria-expanded') === 'true';
          syncButtonState(!expanded);
        });
      });
    })();
  </script>
</body>
</html>
