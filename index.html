<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Personal Site</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="home-page">
  <header class="page-header">
    <h1>Flora Gu | 顧 思悤</h1>
  </header>

  <main>
    <section id="intro">
      <p>
        Quae res in civitate duae plurimum possunt, eae contra nos ambae faciunt in hoc tempore, summa gratia et eloquentia; quarum alterum, C. Aquili, vereor, alteram metuo. Eloquentia Q. Hortensi ne me in dicendo impediat, non nihil commoveor, gratia Sex. Naevi ne P. Quinctio noceat, id vero non mediocriter pertimesco. Neque hoc tanto opere querendum videretur, haec summa in illis esse, si in nobis essent saltem mediocria; verum ita se res habet, ut ego, qui neque usu satis et ingenio parum possum, cum patrono disertissimo comparer, P. Quinctius, cui tenues opes, nullae facultates, exiguae amicorum copiae sunt, cum adversario gratiosissimo contendat. Illud quoque nobis accedit incommodum, quod M. Iunius, qui hanc causam aliquotiens apud te egit, homo et in aliis causis exercitatus et in hac multum ac saepe versatus, hoc tempore abest nova legatione impeditus, et ad me ventum est qui, ut summa haberem cetera, temporis quidem certe vix satis habui ut rem tantam, tot controversiis implicatam, possem cognoscere. Ita quod mihi consuevit in ceteris causis esse adiumento, id quoque in hac causa deficit. Nam, quod ingenio minus possum, subsidium mihi diligentia comparavi; quae quanta sit, nisi tempus et spatium datum sit, intellegi non potest. Quae quo plura sunt, C. Aquili, eo te et hos qui tibi in consilio sunt meliore mente nostra verba audire oportebit, ut multis incommodis veritas debilitata tandem aequitate talium virorum recreetur. Quod si tu iudex nullo praesidio fuisse videbere contra vim et gratiam solitudini atque inopiae, si apud hoc consilium ex opibus, non ex veritate causa pendetur, profecto nihil est iam sanctum atque sincerum in civitate, nihil est quod humilitatem cuiusquam gravitas et virtus iudicis consoletur. Certe aut apud te et hos qui tibi adsunt veritas valebit, aut ex hoc loco repulsa vi et gratia locum ubi consistat reperire non poterit.
      </p>
    </section>

    <section id="papers">
      <header class="section-header">
        <h2>Papers &amp; Essays</h2>
        <button class="toggle-slots" type="button" aria-expanded="false" aria-controls="papers-slots" data-show-text="Show" data-hide-text="Hide">Show</button>
      </header>
      <div class="slots" id="papers-slots" hidden>
        <div class="slot slot-placeholder" aria-label="Add paper link"></div>
        <div class="slot slot-placeholder" aria-label="Add paper link"></div>
        <div class="slot slot-placeholder" aria-label="Add paper link"></div>
      </div>
    </section>

    <section id="writings">
      <header class="section-header">
        <h2>Casual writings &amp; Collection of folk texts </h2>
        <button class="toggle-slots" type="button" aria-expanded="false" aria-controls="writings-slots" data-show-text="Show" data-hide-text="Hide">Show</button>
      </header>
      <div class="slots" id="writings-slots" hidden>
        <div class="slot slot-placeholder" aria-label="Add writing link"></div>
        <div class="slot slot-placeholder" aria-label="Add writing link"></div>
        <div class="slot slot-placeholder" aria-label="Add writing link"></div>
      </div>
    </section>

    <section id="cv">
      <header class="section-header">
        <h2>CV</h2>
        <button class="toggle-slots" type="button" aria-expanded="false" aria-controls="cv-slots" data-show-text="Show" data-hide-text="Hide">Show</button>
      </header>
      <div class="slots" id="cv-slots" hidden>
        <iframe
          src="https://docs.google.com/gview?embedded=true&url=https%3A%2F%2Fdrive.google.com%2Fuc%3Fexport%3Ddownload%26id%3D1kWJDU0prcTPiqW-G9fVHpHVG9HC_RVza"
          width="100%"
          height="450"
          style="border:0;"
          allow="fullscreen"
        ></iframe>
      </div>
    </section>
  </main>

  <footer></footer>

  <script src="papers-data.js"></script>
  <script>
    (function () {
      const normalizeDocuments = (value) =>
        Array.isArray(value) ? value.filter((doc) => doc && doc.title) : [];

      const populateSlots = (slotsElement, documents, { targetPage }) => {
        if (!slotsElement || !documents.length) {
          return;
        }

        const fragment = document.createDocumentFragment();

        documents.forEach((doc) => {
          const link = document.createElement('a');
          link.className = 'slot slot-link';

          const label = document.createElement('span');
          label.className = 'slot-link-label';
          label.textContent = doc.title;

          let href = targetPage;
          if (doc.id && !String(doc.id).startsWith('REPLACE_WITH')) {
            href = `${targetPage}?doc=${encodeURIComponent(doc.id)}`;
            link.setAttribute('data-doc-id', doc.id);
          }

          link.href = href;

          const icon = document.createElement('span');
          icon.className = 'slot-link-icon';
          icon.setAttribute('aria-hidden', 'true');
          icon.textContent = '↗';

          link.append(label, icon);
          fragment.appendChild(link);
        });

        slotsElement.replaceChildren(fragment);
      };

      populateSlots(
        document.getElementById('papers-slots'),
        normalizeDocuments(window.papersDocuments),
        { targetPage: 'papers.html' }
      );

      populateSlots(
        document.getElementById('writings-slots'),
        normalizeDocuments(window.casualWritingDocuments),
        { targetPage: 'writings.html' }
      );

      document.querySelectorAll('.toggle-slots').forEach((button) => {
        const controlsId = button.getAttribute('aria-controls');
        const slots = controlsId
          ? document.getElementById(controlsId)
          : button.closest('section')?.querySelector('.slots');

        if (!slots) {
          return;
        }

        const showLabel = button.dataset.showText || 'Show';
        const hideLabel = button.dataset.hideText || 'Hide';

        const syncButtonState = (expanded) => {
          button.setAttribute('aria-expanded', String(expanded));
          slots.hidden = !expanded;
          button.textContent = expanded ? hideLabel : showLabel;
        };

        const initialExpanded = button.getAttribute('aria-expanded');
        syncButtonState(initialExpanded === 'false' ? false : true);

        button.addEventListener('click', () => {
          const expanded = button.getAttribute('aria-expanded') === 'true';
          syncButtonState(!expanded);
        });
      });
    })();
  </script>
</body>
</html>
